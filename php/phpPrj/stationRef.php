<?php



include_once "stationRef.php";
include_once "sqlTimetable.php";
include_once  "QueryAnswer.php";
$tableName=array(1001,
    1002,
    1003,
    1004,
    1005,
    1006,
    1007,
    1008,
    1009,
    1011,
    1032,
    1012,
    1013,
    1014,
    1015,
    1016,
    1017,
    1018,
    1019,
    1020,
    1021,
    1022,
    1023,
    1024,
    1025,
    1026,
    1027,
    1028,
    1029,
    1030,
    1031,
    1034,
    1102,
    1103,
    1104,
    1105,
    1106,
    1107,
    1108,
    1109,
    1110,
    1111,
    1112,
    1113,
    1114,
    1115,
    1116,
    1117,
    1118,
    1119,
    1120,
    1202,
    1203,
    1204,
    1205,
    1206,
    1207,
    1208,
    1209,
    1210,
    1211,
    1212,
    1213,
    1214,
    1215,
    1217,
    1218,
    1219,
    1220,
    1221,
    1222,
    1223,
    1224,
    1225,
    1226,
    1227,
    1228,
    1229,
    1230,
    1231,
    1232,
    1233,
    1234,
    1235,
    1236,
    1237,
    1238,
    1239,
    1240,
    1241,
    1242,
    1302,
    1304,
    1305,
    1307,
    1308,
    1310,
    1314,
    1315,
    1317,
    1318,
    1319,
    1320,
    1321,
    1322,
    1323,
    1324,
    1402,
    1403,
    1404,
    1405,
    1406,
    1407,
    1408,
    1409,
    1410,
    1411,
    1412,
    1413,
    1414,
    1415,
    1416,
    1417,
    1418,
    1502,
    1503,
    1504,
    1505,
    1506,
    1507,
    1508,
    1510,
    1511,
    1512,
    1514,
    1516,
    1517,
    1602,
    1604,
    1605,
    1606,
    1607,
    1608,
    1609,
    1610,
    1611,
    1612,
    1613,
    1614,
    1616,
    1617,
    1619,
    1620,
    1621,
    1622,
    1623,
    1624,
    1625,
    1626,
    1627,
    1628,
    1629,
    1630,
    1631,
    1632,
    1633,
    1634,
    1635,
    1703,
    1704,
    1705,
    1706,
    1708,
    1709,
    1710,
    1711,
    1712,
    1713,
    1714,
    1715,
    1802,
    1803,
    1804,
    1805,
    1806,
    1807,
    1808,
    1809,
    1810,
    1811,
    1812,
    1813,
    1814,
    1815,
    1816,
    1817,
    1818,
    1819,
    1820,
    1821,
    1822,
    1823,
    1824,
    1825,
    1826,
    1827,
    1903,
    1904,
    1905,
    1906,
    1907,
    1908,
    2002,
    2102,
    2103,
    2104,
    2105,
    2106,
    2107,
    2108,
    2109,
    2110,
    2212,
    2213,
    2203,
    2214,
    2204,
    2205,
    2206,
    2207,
    2208,
    2209,
    2210,
    2211,
    2302,
    2402,
    2502,
    2702,
    2703,
    2704,
    2705,
    2706,
    2707,
    2802,
    2902,
    3102,
    3202,
    3302,
    3402,
    3902,
    4102,
    4202,
    4302,
    1244,
    5101,
    5102,
    1033,
    6103,
    1243,
    1035,
    2003,
    1036);


$stationName=array('基隆',
    '八堵',
    '七堵',
    '五堵',
    '汐止',
    '南港',
    '松山',
    '台北',
    '萬華',
    '板橋',
    '浮洲',
    '樹林',
    '山佳',
    '鶯歌',
    '桃園',
    '內壢',
    '中壢',
    '埔心',
    '楊梅',
    '富岡',
    '湖口',
    '新豐',
    '竹北',
    '北新竹',
    '新竹',
    '香山',
    '崎頂',
    '竹南',
    '三坑',
    '百福',
    '汐科',
    '南樹林',
    '談文',
    '談文南',
    '大山',
    '後龍',
    '龍港',
    '白沙屯',
    '新埔',
    '通霄',
    '苑裡',
    '日南',
    '大甲',
    '台中港',
    '清水',
    '沙鹿',
    '龍井',
    '大肚',
    '追分',
    '大肚溪南',
    '彰化',
    '花壇',
    '員林',
    '永靖',
    '社頭',
    '田中',
    '二水',
    '林內',
    '石榴',
    '斗六',
    '斗南',
    '石龜',
    '大林',
    '民雄',
    '嘉義',
    '水上',
    '南靖',
    '後壁',
    '新營',
    '柳營',
    '林鳳營',
    '隆田',
    '拔林',
    '善化',
    '新市',
    '永康',
    '台南',
    '保安',
    '中洲',
    '大湖',
    '路竹',
    '岡山',
    '橋頭',
    '楠梓',
    '左營',
    '鼓山',
    '高雄',
    '大橋',
    '大村',
    '嘉北',
    '新左營',
    '造橋',
    '豐富',
    '苗栗',
    '南勢',
    '銅鑼',
    '三義',
    '泰安',
    '后里',
    '豐原',
    '潭子',
    '台中',
    '烏日',
    '成功',
    '大慶',
    '太原',
    '新烏日',
    '鳳山',
    '後庄',
    '九曲堂',
    '六塊厝',
    '屏東',
    '歸來',
    '麟洛',
    '西勢',
    '竹田',
    '潮州',
    '崁頂',
    '南州',
    '鎮安',
    '林邊',
    '佳冬',
    '東海',
    '枋寮',
    '加祿',
    '內獅',
    '枋山',
    '枋野',
    '中央',
    '古莊',
    '大武',
    '瀧溪',
    '多良',
    '金崙',
    '太麻里',
    '知本',
    '康樂',
    '吉安',
    '志學',
    '平和',
    '壽豐',
    '豐田',
    '溪口',
    '南平',
    '鳳林',
    '萬榮',
    '光復',
    '大富',
    '富源',
    '瑞穗',
    '三民',
    '玉里',
    '安通',
    '東里',
    '東竹',
    '富里',
    '池上',
    '海端',
    '關山',
    '月美',
    '瑞和',
    '瑞源',
    '鹿野',
    '山里',
    '台東',
    '馬(廢)蘭',
    '台(廢)東',
    '舞鶴',
    '永樂',
    '東澳',
    '南澳',
    '武塔',
    '漢本',
    '和平',
    '和仁',
    '崇德',
    '新城',
    '景美',
    '北埔',
    '花蓮',
    '暖暖',
    '四腳亭',
    '瑞芳',
    '侯硐',
    '三貂嶺',
    '牡丹',
    '雙溪',
    '貢寮',
    '福隆',
    '石城',
    '大里',
    '大溪',
    '龜山',
    '外澳',
    '頭城',
    '頂埔',
    '礁溪',
    '四城',
    '宜蘭',
    '二結',
    '中里',
    '羅東',
    '冬山',
    '新馬',
    '蘇澳新',
    '蘇澳',
    '大華',
    '十分',
    '望古',
    '嶺腳',
    '平溪',
    '菁桐',
    '深澳',
    '五福',
    '林口',
    '電廠',
    '桃中',
    '寶山',
    '南祥',
    '長興',
    '海山站',
    '海湖站',
    '千甲',
    '新莊',
    '竹中',
    '六家',
    '上員',
    '竹東',
    '橫山',
    '九讚頭',
    '合興',
    '富貴',
    '內灣',
    '榮華',
    '台中港貨',
    '龍井煤場',
    '神岡',
    '源泉',
    '濁水',
    '龍泉',
    '集集',
    '水里',
    '車埕',
    '南調',
    '高雄港',
    '前鎮',
    '花蓮港',
    '中興一號',
    '中興二號',
    '機廠',
    '樹調',
    '東港支線',
    '東南支線',
    '南科',
    '長榮大學',
    '沙崙',
    '北湖',
    '海科館',
    '仁德',
    '三姓橋',
    '八斗子',
    '新富'
);

//echo orderSearchStation(105,1,$tableName,$stationName,$mysqli);

class MovingCarInfo{
    var $Station,$ArrTime,$DepTime;


}


function orderSearchStation($train,$order,$tableName,$stationName,$mysqli){

    foreach($tableName as $v){

        $sql="select `Station`,`DepTime`,`ArrTime` from `{$v}` where `Train`={$train} and `Order`={$order}";
        $result=$mysqli->query($sql);
        if($result->num_rows>0){
            $data=$result->fetch_object("QueryAnswer"); //result is station number must covert to chinese
            $movingCarInfo= new MovingCarInfo();
            $movingCarInfo->Station=numberSearchStation($tableName,$stationName,$data->Station);
            $movingCarInfo->ArrTime=$data->ArrTime;
            $movingCarInfo->DepTime=$data->DepTime;
            return $movingCarInfo;



        }

    }


}

function numberSearchStation($tableName,$stationName,$stationNumber){
    foreach ($tableName as $k=>$v){
        if($v==$stationNumber){

            return $stationName[$k];
        }

    }

}


function numberSearchCarClass($carClassNum){

    if(substr($carClassNum,0,3)=='110') {

        return "自強";
    }else if(substr($carClassNum,0,3)=='111'){

        return "莒光";
    }else if(substr($carClassNum,0,3)=='112'){

        return "復興";
    }else if(substr($carClassNum,0,3)=='113'){

        return "區間";
    }else if(substr($carClassNum,0,3)=='114'){


        return "普快";
    }else{

        return "普";
    }
}

